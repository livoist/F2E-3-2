(window.webpackJsonp=window.webpackJsonp||[]).push([[5,2,3,4],{277:function(e,t,n){var content=n(281);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(42).default)("d6817240",content,!0,{sourceMap:!1})},278:function(e,t,n){var content=n(283);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(42).default)("136a6ba0",content,!0,{sourceMap:!1})},279:function(e,t,n){var content=n(285);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(42).default)("2926947f",content,!0,{sourceMap:!1})},280:function(e,t,n){"use strict";n(277)},281:function(e,t,n){var r=n(41)(!1);r.push([e.i,".loading-page[data-v-372f35f5]{width:100vw;height:100vh;display:flex;justify-content:center;align-items:center;position:fixed;top:0;left:0;background:hsla(0,0%,100%,.8);font-size:30px;opacity:0;visibility:hidden;transition:.3s;font-weight:700;letter-spacing:8px;color:#7e7e7e;z-index:9}@media(max-width:575px){.loading-page[data-v-372f35f5]{font-size:5.5vmin}}.loading-page.loading[data-v-372f35f5]{opacity:1;visibility:visible}",""]),e.exports=r},282:function(e,t,n){"use strict";n(278)},283:function(e,t,n){var r=n(41)(!1);r.push([e.i,'@-webkit-keyframes fadeText-data-v-1a98ae7e{0%{opacity:0}to{opacity:1}}@keyframes fadeText-data-v-1a98ae7e{0%{opacity:0}to{opacity:1}}.enterAnim[data-v-1a98ae7e]{background:#fff;width:100vw;height:100vh;position:fixed;top:0;left:0;z-index:10;display:flex;justify-content:center;align-items:center;flex-direction:column;transition:.5s}.enterAnim.enter[data-v-1a98ae7e]{opacity:0;visibility:hidden}.enterAnim p[data-v-1a98ae7e]{line-height:2;font-family:"LiHei Pro","黑體-繁","微軟正黑體",sans-serif;font-weight:700;letter-spacing:2px}.enterAnim p[data-v-1a98ae7e]:first-of-type{font-size:24px;position:relative}@media(max-width:575px){.enterAnim p[data-v-1a98ae7e]:first-of-type{font-size:4vmin}}.enterAnim p[data-v-1a98ae7e]:nth-of-type(2){font-size:16px;letter-spacing:2px;-webkit-animation:fadeText-data-v-1a98ae7e 1s linear infinite alternate both;animation:fadeText-data-v-1a98ae7e 1s linear infinite alternate both}@media(max-width:575px){.enterAnim p[data-v-1a98ae7e]:nth-of-type(2){font-size:3vmin}}',""]),e.exports=r},284:function(e,t,n){"use strict";n(279)},285:function(e,t,n){var r=n(41)(!1);r.push([e.i,'.markerDetail[data-v-e64b901c]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:8;background:rgba(0,0,0,.85);color:#fff;padding:0 20px;font-size:14px;font-weight:700;font-family:"LiHei Pro","黑體-繁","微軟正黑體",sans-serif;opacity:0;visibility:hidden;transition:.3s;border-radius:4px}@media(max-width:575px){.markerDetail[data-v-e64b901c]{width:68%;font-size:3.5vmin;padding:0 5.5vmin}}.markerDetail[data-v-e64b901c]:before{position:absolute;left:-24px;top:-30px;font-size:20px}@media(max-width:575px){.markerDetail[data-v-e64b901c]:before{font-size:4.5vmin}}.markerDetail.restaurant[data-v-e64b901c]{border:4px solid #ee3239}.markerDetail.restaurant[data-v-e64b901c]:before{content:"Restaurant";color:#ee3239}.markerDetail.scenicSpot[data-v-e64b901c]{border:4px solid #5eaa5f}.markerDetail.scenicSpot[data-v-e64b901c]:before{content:"ScenicSpot";color:#5eaa5f}.markerDetail.hotel[data-v-e64b901c]{border:4px solid #fece00}.markerDetail.hotel[data-v-e64b901c]:before{content:"Hotel";color:#fece00}.markerDetail.open[data-v-e64b901c]{opacity:1;visibility:visible}.markerDetail>p[data-v-e64b901c]{margin:16px 0;line-height:1.5}.closeModal[data-v-e64b901c]{width:24px;height:24px;border-radius:50%;background:#000;position:absolute;right:-30px;top:-30px;cursor:pointer}@media(max-width:575px){.closeModal[data-v-e64b901c]{right:-7vmin;top:-7vmin}}.closeModal[data-v-e64b901c]:after,.closeModal[data-v-e64b901c]:before{content:"";position:absolute;width:70%;height:2px;background:#fff;left:50%;top:50%}.closeModal[data-v-e64b901c]:before{transform:translate(-50%,-50%) rotate(45deg)}.closeModal[data-v-e64b901c]:after{transform:translate(-50%,-50%) rotate(-45deg)}.closeModal.restaurant[data-v-e64b901c]{border:2px solid #ee3239}.closeModal.restaurant[data-v-e64b901c]:after,.closeModal.restaurant[data-v-e64b901c]:before{background:#ee3239}.closeModal.scenicSpot[data-v-e64b901c]{border:2px solid #5eaa5f}.closeModal.scenicSpot[data-v-e64b901c]:after,.closeModal.scenicSpot[data-v-e64b901c]:before{background:#5eaa5f}.closeModal.hotel[data-v-e64b901c]{border:2px solid #fece00}.closeModal.hotel[data-v-e64b901c]:after,.closeModal.hotel[data-v-e64b901c]:before{background:#fece00}',""]),e.exports=r},286:function(e,t,n){var content=n(292);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(42).default)("7bfd72ea",content,!0,{sourceMap:!1})},287:function(e,t,n){"use strict";n.r(t);var r={computed:{isLoading:function(){return this.$store.state.loading}}},o=(n(280),n(17)),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"loading-page",class:{loading:e.isLoading}},[n("p",[e._v("Loading...")])])}),[],!1,null,"372f35f5",null);t.default=component.exports},288:function(e,t,n){"use strict";n.r(t);n(65);var r={name:"EnterAnimation",data:function(){return{pageIn:!1}},computed:{isLadongSource:function(){return this.$store.state.loadingSource}},watch:{immediate:!0,isLadongSource:{handler:function(e){var t=this;e&&setTimeout((function(){t.pageIn=!0}),1e3)}}}},o=(n(282),n(17)),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"enterAnim",class:{enter:e.pageIn}},[n("p",[e._v("Welcome to BikeMap")]),n("p",{class:{isAnText:!e.isLadongSource}},[e._v("waiting loading...")])])}),[],!1,null,"1a98ae7e",null);t.default=component.exports},289:function(e,t,n){"use strict";n.r(t);var r={name:"MarkerDetailModal",props:{modalType:{type:String,default:""},info:{type:Object,default:function(){return{}}}},computed:{isOpenModal:function(){return this.$store.state.openModal}},methods:{closeModal:function(){this.$store.dispatch("isOpenModal",!1)},checkContent:function(content){return null==content||""===content?"尚未提供":content}}},o=(n(284),n(17)),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"markerDetail",class:[""+e.modalType,{open:e.isOpenModal}]},[n("div",{staticClass:"closeModal",class:""+e.modalType,on:{click:function(t){return e.closeModal()}}}),n("p",[e._v("名稱 / Name: "+e._s(e.checkContent(e.info.name)))]),n("p",[e._v("地址 / Address: "+e._s(e.checkContent(e.info.add)))]),n("p",[e._v("營業時間 / Time: "+e._s(e.checkContent(e.info.open)))]),n("p",[e._v("電話 / Phone: "+e._s(e.checkContent(e.info.phone)))])])}),[],!1,null,"e64b901c",null);t.default=component.exports},290:function(e,t,n){"use strict";var r=n(7),o=n(66).findIndex,c=n(103),l="findIndex",d=!0;l in[]&&Array(1).findIndex((function(){d=!1})),r({target:"Array",proto:!0,forced:d},{findIndex:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),c(l)},291:function(e,t,n){"use strict";n(286)},292:function(e,t,n){var r=n(41)(!1);r.push([e.i,'.popup-flex{display:flex}.popup-flex p:first-of-type{margin-right:20px}.popup-content span:first-of-type{color:#f2dd66}@-webkit-keyframes userPoint{0%{box-shadow:0 0 0 hsla(0,0%,63.9%,.7)}60%{opacity:1}to{box-shadow:0 0 4px #a3a3a3,0 0 4px #a3a3a3,0 0 4px #a3a3a3,0 0 4px #a3a3a3,0 0 4px #a3a3a3,0 0 4px #a3a3a3,0 0 4px #a3a3a3}}@keyframes userPoint{0%{box-shadow:0 0 0 hsla(0,0%,63.9%,.7)}60%{opacity:1}to{box-shadow:0 0 4px #a3a3a3,0 0 4px #a3a3a3,0 0 4px #a3a3a3,0 0 4px #a3a3a3,0 0 4px #a3a3a3,0 0 4px #a3a3a3,0 0 4px #a3a3a3}}.marker{width:12px;height:12px;border-radius:50%;position:absolute;border:3px solid #a3a3a3;transition:.3s;z-index:1}.marker.hidden{opacity:0;visibility:hidden}.marker.self{background:#172532;-webkit-animation:userPoint .5s infinite alternate both;animation:userPoint .5s infinite alternate both}.marker.restaurant{background:#ee3239}.marker.scenicSpot{background:#5eaa5f}.marker.hotel{background:#fece00}.textBlock{position:absolute;top:-42px;left:50%;z-index:0;width:50px;transform:translateX(-50%);font-size:12px;text-align:center;line-height:26px;background:#000;color:#fff;border-radius:6px}.textBlock.self{width:50px}.textBlock.hotel,.textBlock.restaurant,.textBlock.scenicSpot{min-width:100px;padding:0 5px}.textBlock:after{content:"";position:absolute;bottom:-8px;left:50%;z-index:0;width:0;height:0;border-color:#000 transparent transparent;border-style:solid;border-width:8px 5px 0;transform:translateX(-50%)}',""]),e.exports=r},293:function(e,t,n){"use strict";n.r(t);n(35),n(24),n(34),n(48),n(49);var r=n(4),o=n(3),c=(n(27),n(65),n(28),n(290),n(58),n(11),n(29),n(43),n(38));function l(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var f={data:function(){return{station:"",target:"",mapInstance:null,mapMarker:null,mapPopup:null,selfPosMarker:[],stationMarker:[],nearStationMarkers:[],nearRestaruantMarkers:[],nearScenicSpotMarkers:[],nearHotelMarkers:[],curMarkerDetailInfo:{},curModalType:""}},computed:d({},Object(c.c)({getCurStationTarget:"curTarget",getCurBikeGeometry:"curBikePath",getCurNearByStation:"stationNearBy",getUserPosition:"userPos",getCurNearItem:"nearNameItem",getAvailabilityNearByArray:"availabilityNearBy",getStationRents:"availability",getRestaruant:"restaurantNearBy",getScenicSpot:"scenicSpotNearBy",getHotel:"hotelNearBy",isClearMarkers:"isClearMakers",isClearBikePath:"isClearBikePath",getBasicSelect:"basicSelect",updateUserPosSelect:"updateUserPosSelect"})),watch:{getCurBikeGeometry:{deep:!0,handler:function(e){0!==e.length&&this.getBikePath(e)}},getBasicSelect:{deep:!0,handler:function(e){e&&(this.getBikeStationMarker(this.getCurStationTarget),this.changeBasicSelect(!1),this.getStationNearByMarkers("restaurant",this.getRestaruant,this.nearRestaruantMarkers),this.getStationNearByMarkers("scenicSpot",this.getScenicSpot,this.nearScenicSpotMarkers),this.getStationNearByMarkers("hotel",this.getHotel,this.nearHotelMarkers))}},updateUserPosSelect:{deep:!0,handler:function(e){e&&(this.getUserCurPosNearByStation(this.getCurNearByStation),this.getCurNearSelectMarker(this.getCurNearItem),this.isUpdateUserPosSelect(!1))}},getRestaruant:{immediate:!0,deep:!0,handler:function(e){e.length>0&&this.getStationNearByMarkers("restaurant",this.getRestaruant,this.nearRestaruantMarkers)}},getScenicSpot:{immediate:!0,deep:!0,handler:function(e){e.length>0&&this.getStationNearByMarkers("scenicSpot",this.getScenicSpot,this.nearScenicSpotMarkers)}},getHotel:{immediate:!0,deep:!0,handler:function(e){e.length>0&&this.getStationNearByMarkers("hotel",this.getHotel,this.nearHotelMarkers)}},isClearMarkers:{immediate:!0,handler:function(e){e&&(this.clearOldMarkers(this.stationMarker),this.clearOldMarkers(this.nearRestaruantMarkers),this.clearOldMarkers(this.nearScenicSpotMarkers),this.clearOldMarkers(this.nearHotelMarkers),this.isClearInfoMarker(!1))}},isClearBikePath:{immediate:!0,handler:function(e){e&&(this.clearBikePath(),this.isClearInfoBikePath(!1))}}},methods:d(d({},Object(c.b)(["changeBasicSelect","isClearInfoMarker","isClearInfoBikePath","getAllStation","isUpdateUserPosSelect","isLoadingSource"])),{},{initMapBox:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new e.$map.Map({accessToken:"pk.eyJ1IjoiYmVubGFpIiwiYSI6ImNrdzRib2FzYTAydTQyb3JoaHU4MGVzcWoifQ.j-bTKoCaWwbV4Ldqvy2Vrg",container:"map",style:"mapbox://styles/mapbox/light-v10",center:[120.9738819,23.97565],zoom:7});case 2:return e.mapInstance=t.sent,t.next=5,new e.$map.Marker;case 5:return e.mapMarker=t.sent,t.next=8,new e.$map.Popup;case 8:e.mapPopup=t.sent,setTimeout((function(){e.isLoadingSource(!0)}),2e3);case 10:case"end":return t.stop()}}),t)})))()},getCurNearSelectMarker:function(e){var t=e.pos,n=e.name,r=this.getCurNearByStation.findIndex((function(e){return e.StationName.Zh_tw===n.Zh_tw})),o=this.getAvailabilityNearByArray[r],c=o.AvailableRentBikes,l=o.AvailableReturnBikes,d=o.UpdateTime;this.nearStationMarkers[r].setPopup(this.mapPopup.setHTML('\n              <p class="popup-content">\n                <span>Address :</span> \n                <span>'.concat(e.address.Zh_tw,'</span>\n              </p>\n              <div class="popup-flex">\n                <p class="popup-content">\n                  <span>CanRent : </span>\n                  <span>').concat(c,'</span>\n                </p>\n                <p class="popup-content">\n                  <span>NotReturn : </span>\n                  <span>').concat(l,'</span>\n                </p>\n              </div>\n              <p class="popup-content">\n                <span>LastUpdateTimes : </span>\n                <br />\n                <span>').concat(d,"</span>\n                </p>\n            "))).togglePopup(),this.mapInstance.jumpTo({center:[t.PositionLon,t.PositionLat],zoom:14,speed:2,curve:1,duration:5e3,easing:function(e){return e}})},clearOldMarkers:function(e){e.length>0&&(e.forEach((function(e){return e.remove()})),e=[])},clearBikePath:function(){var e=this;["route","point-start","point-end"].forEach((function(t){e.mapInstance.getLayer(t)&&e.mapInstance.removeLayer(t),e.mapInstance.getSource(t)&&e.mapInstance.removeSource(t)}))},createCustomPoint:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=document.createElement("div"),o=document.createElement("div");return"SELF"===t?(o.innerHTML=t,r.classList.add("marker",e),o.classList.add("textBlock",e)):(o.innerHTML=t.name.length>8?"".concat(t.name.slice(0,7),"..."):t.name,r.classList.add("marker",e,"hidden"),o.classList.add("textBlock",e,"".concat(e,"-").concat(n))),r.appendChild(o),r},getStationNearByMarkers:function(e,t,n){var r=this;n.length>0&&(n.forEach((function(e){return e.remove()})),n=[]),t.slice().forEach((function(t,n){var o=r.createCustomPoint(e,t,n),c=new r.$map.Marker(o),l={type:e,idx:n,info:t};c.setLngLat(t.pos).addTo(r.mapInstance),r.nearRestaruantMarkers.push(c),r.addEventListenerToMarker(l)}))},getUserCurPosNearByStation:function(e){var t=this;this.nearStationMarkers.length>0&&(this.nearStationMarkers.forEach((function(e){return e.remove()})),this.nearStationMarkers=[]),this.selfPosMarker.length>0&&(this.selfPosMarker.forEach((function(e){return e.remove()})),this.selfPosMarker=[]);var n=this.createCustomPoint("self","SELF"),r=new this.$map.Marker(n);r.setLngLat(this.getUserPosition).addTo(this.mapInstance),this.selfPosMarker.push(r),e.forEach((function(e){var n=e.StationName,r=e.StationPosition,o=new t.$map.Marker;o.setLngLat([r.PositionLon,r.PositionLat]).setPopup(t.mapPopup.setHTML(n.Zh_tw)).addTo(t.mapInstance),t.nearStationMarkers.push(o)})),this.mapInstance.jumpTo({center:this.getUserPosition,zoom:14,speed:2,curve:1,duration:5e3,easing:function(e){return e}})},getBikeStationMarker:function(e){this.clearOldMarkers(this.stationMarker),this.mapMarker.setLngLat([e.pos.PositionLon,e.pos.PositionLat]).setPopup(this.mapPopup.setHTML(e.address)).addTo(this.mapInstance).togglePopup(!0),this.stationMarker.push(this.mapMarker),this.mapInstance.jumpTo({center:[e.pos.PositionLon,e.pos.PositionLat],zoom:14,speed:2,curve:1,duration:5e3,easing:function(e){return e}})},getBikePath:function(path){this.clearBikePath(),this.mapInstance.addSource("route",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:path}}}),this.mapInstance.addSource("point-start",{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{description:"Start"},geometry:{type:"Point",coordinates:[path[0][0],path[0][1]]}}]}}),this.mapInstance.addSource("point-end",{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{description:"End"},geometry:{type:"Point",coordinates:[path[path.length-1][0],path[path.length-1][1]]}}]}}),this.mapInstance.addLayer({id:"route",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#CC8A4D","line-width":4,"line-opacity":.6}}),this.mapInstance.addLayer({id:"point-start",type:"circle",source:"point-start",paint:{"circle-color":"#FEC804","circle-stroke-width":2,"circle-stroke-color":"#3A5A69","circle-radius":5}}),this.mapInstance.addLayer({id:"point-end",type:"circle",source:"point-end",paint:{"circle-color":"#C2E3F4","circle-stroke-width":2,"circle-stroke-color":"#3A5A69","circle-radius":5}});var e=Math.floor(path.length/2),t=window.innerWidth;this.mapInstance.jumpTo({center:[path[e][0],path[e][1]],zoom:e>40&&t>575?11:e>40&&t<575?9:e<40?13:void 0,speed:2,curve:1,duration:5e3,easing:function(e){return e}})},getBikeStation:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.getAllStation(e);case 2:t.station=t.$store.state.station;case 3:case"end":return n.stop()}}),n)})))()},getCurMarkerDetailInfo:function(e,t){this.curMarkerDetailInfo=t,this.curModalType=e,this.$store.dispatch("isOpenModal",!0)},addEventListenerToMarker:function(e){var t=this,n=e.type,r=e.idx,o=e.info;document.querySelector(".".concat(n,"-").concat(r)).addEventListener("click",(function(){return t.getCurMarkerDetailInfo(n,o)}))},removeEventListenerToMarker:function(){var e=this;document.querySelectorAll(".marker").forEach((function(t){return t.removeEventListener("click",e.getCurMarkerDetailInfo(e.curMarkerDetailInfo))}))}}),mounted:function(){this.initMapBox()},beforeDestroyed:function(){this.removeEventListenerToMarker()}},h=f,m=(n(291),n(17)),component=Object(m.a)(h,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"map"}},[n("LoadingPage"),n("EnterAnimation"),n("MarkerDetailModal",{attrs:{modalType:e.curModalType,info:e.curMarkerDetailInfo}})],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{LoadingPage:n(287).default,EnterAnimation:n(288).default,MarkerDetailModal:n(289).default})}}]);